# 1ë‹¨ê³„ ìˆ˜ì •: config.yaml (WebSocket URL ìˆ˜ì •)

api:
  # âœ… ì •í™•í•œ KIS API URL
  base_url: "https://openapi.koreainvestment.com:9443"
  
  # ğŸ”¥ í•µì‹¬ ìˆ˜ì •: /websocket ê²½ë¡œ ì¶”ê°€
  websocket_url: "ws://ops.koreainvestment.com:21000"  # âœ… ì‹¤ì „ ê³„ì¢Œìš©
  # websocket_url: "ws://ops.koreainvestment.com:21000/websocket"  # ì‹¤ì „ìš©

system:
  max_reconnect_attempts: 10
  base_reconnect_delay: 2
  reconnect_delay: 60
  order_retry_attempts: 3
  token_refresh_margin_minutes: 5
  cleanup_interval_hours: 6
  graceful_shutdown_timeout: 30
  state_persistence: true
  state_file: "/tmp/auto-sell-order-state.json"

trading:
  profit_margin: 0.03
  default_order_type: "00"
  exchange_code: "NASD"
  timezone: "US/Eastern"
  
  # ğŸ”¥ í•µì‹¬ ì¶”ê°€: ê¸°ë³¸ ê°ì‹œ ì¢…ëª© ì§€ì •
  default_symbol: "AAPL"  # WebSocket tr_key ê¸°ë³¸ê°’

# ë‚˜ë¨¸ì§€ ì„¤ì •ì€ ê¸°ì¡´ ìœ ì§€
polling:
  aggressive:
    time_ranges:
      - start: "17:00"
        end: "18:00"
      - start: "21:30"
        end: "23:00"
      - start: "22:30"
        end: "05:00"
      - start: "05:00"
        end: "08:00"
    interval: 3
    batch_size: 10
    
  smart:
    time_ranges:
      - start: "08:00"
        end: "17:00"
    initial_interval: 5
    max_interval: 20
    backoff_multiplier: 1.5
    batch_size: 5
    no_change_threshold: 5           # âœ… ì¶”ê°€
    consecutive_success_speedup: false  # âœ… ì¶”ê°€
    order_age_factor:                # âœ… ì¶”ê°€
    - minutes: 30
      interval: 15
    - minutes: 60
      interval: 20
    - default: 5

rate_limit:
  requests_per_second: 15
  daily_limit: 10000
  hourly_limit: 1000
  max_consecutive_requests: 10
  consecutive_delay: 2.5
  min_request_interval: 2.5
  aggressive_mode_limit: 5000   # âœ… ì¶”ê°€
  smart_mode_limit: 3000         # âœ… ì¶”ê°€
  rate_limit_codes: ["EGW00101", "EGW00102"]
  rate_limit_retry_delay: 60
  cooldown_on_limit: 60          # âœ… ì¶”ê°€

market_hours:
  premarket:
    start: "04:00"
    end: "09:30"
    description: "í”„ë¦¬ë§ˆì¼“ - REST í´ë§"
  regular:
    start: "09:30"
    end: "16:00"
    description: "ì •ê·œì¥ - WebSocket ì‹¤ì‹œê°„"
  aftermarket:
    start: "16:00"
    end: "20:00"
    description: "ì• í”„í„°ë§ˆì¼“ - REST í´ë§"
  closed:
    start: "20:00"
    end: "04:00"
    description: "ì¥ ë§ˆê° - ëŒ€ê¸° ëª¨ë“œ"

telegram:
  polling_interval: 10
  error_polling_interval: 30
  timeout: 10
  max_message_length: 4000
  notifications:
    startup: true
    shutdown: true
    execution: true
    error: true
    order_success: true
    order_failure: true
    reconnection: false

logging:
  level: "DEBUG"
  format: "%(asctime)s - %(name)s - %(levelname)s - %(message)s"

aws:
  cost_optimization: true
  connection_pooling: true
  request_compression: false
  keep_alive: true
  timeout: 15
  retry_attempts: 3

websocket:
  auto_subscribe: true
  subscribe_all_symbols: false  # falseë¡œ ë³€ê²½í•˜ì—¬ ê¸°ë³¸ ì¢…ëª©ë§Œ êµ¬ë…
  ping_interval: 30
  ping_timeout: 10
  max_reconnect_attempts: 10
  reconnect_delay: 5
  message_queue_size: 1000
  process_timeout: 5